#include "form.h"
#include "ui_form.h"
#include <QDateTime>
#include<QDebug>

Form::Form(QWidget *parent) :
    QWidget(parent),
    tableView(new table()),
//    chartView(new DataChart()),
    ui(new Ui::Form)
{
    ui->setupUi(this);
    QDateTime current_date_time =QDateTime::currentDateTime();
    QString current_date = current_date_time.toString("yyyy.MM.dd hh:mm:ss");
    ui->labelTime->setText(current_date);


    tableView->setParent(ui->frameTable);
//    chartView->setParent(ui->frameChart);

}
Form::~Form()
{
    delete ui;
}

void Form::on_pushButtonEcg_clicked()
{
    QSqlQuery query;
    int id = ui->labelId->text().toInt();
    this->hide();
    QString str = QString("select ecg from patient where id = '%1'").
            arg(id);
    qDebug()<<id;
    if(!query.exec(str))
    {
        QMessageBox::information(this,"Info","查询失败");
    }
    else
    {
        QString qstring;
//        第一个Bug
        while(query.next())
        {
            qstring = query.value(0).toString();
            qDebug()<<qstring;
        }
        //QString qstring = "2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2008, 2016, 2016, 2016, 2024, 2032, 2048,2064, 2064, 2064, 2072, 2080, 2080, 2080, 2088, 2096, 2104,2112, 2112, 2112, 2112, 2112, 2112, 2104, 2096, 2088,2080, 2080, 2080, 2072, 2064, 2064, 2064, 2048, 2032, 2032,2032, 2016, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 1992, 1984, 1976,1968, 1960, 1952, 1944, 1936, 1944, 1952, 2016, 2080, 2136,2192, 2256, 2320, 2376, 2432, 2488, 2544, 2568, 2592, 2536,2480, 2424, 2368, 2304, 2240, 2184, 2128, 2072, 2016, 1968,1920, 1928, 1936, 1944, 1952, 1960, 1968, 1984, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2008, 2016, 2024, 2032, 2032,2032, 2048, 2064, 2064, 2064, 2072, 2080, 2088, 2096, 2104,2112, 2112, 2112, 2120, 2128, 2136, 2144, 2152, 2160, 2160,2160, 2160, 2160, 2168, 2176, 2176, 2176, 2184, 2192,2192, 2192, 2192, 2200, 2208, 2208, 2208, 2208, 2208, 2208,2208, 2200, 2192, 2192, 2192, 2184, 2176, 2176, 2176, 2168,2160, 2160, 2160, 2144, 2128, 2128, 2128, 2128, 2128, 2112,2096, 2088, 2080, 2072, 2064, 2064, 2064, 2048, 2032, 2024,2016, 2016, 2016, 2008, 2000, 2000, 2000, 2000, 2000,2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000";

        analysisReportHome.setqstring(qstring);
        analysisReportHome.show();
    }
}

void Form::receivelogins()
{
    this->show();
}



